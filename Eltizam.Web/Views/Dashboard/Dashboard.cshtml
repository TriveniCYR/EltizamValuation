@model Eltizam.Business.Models.DashboardFilterModel;
@using Eltizam.Utility.Models
@inject IConfiguration Configuration
@inject Microsoft.Extensions.Localization.IStringLocalizer<Eltizam.Resource.Shared> SharedLocalizer
@{
    string jsVersion = @Configuration.GetSection("StaticJS")["version"];
    var _header = "Dashboard";
    ViewData["Title"] = _header;
}

<main>
    <div class="whiteBoxShadow">
        <div class="heading position-relative flex justify-between">
            <h3 class="dashboardTitle">@_header</h3>
        </div>
        <div class="bodyContent">
            <div class="whiteBoxShadow">
                <div class="inputSearchs">
                    <form id="dashboardFilterForm">
                        <div class="flex dashboardSearch">
                            <label for="ClientTypeId">
                                Client
                                @Html.DropDownListFor(model => model.ClientId, new List<SelectListItem> { }, new { id = "ClientId", @class = "form-control searchable-dropdown" })
                            </label>
                            <label for="PropertyId">
                                Property
                                @Html.DropDownListFor(model => model.PropertyId, new List<SelectListItem> { }, new { id = "PropertyId",@class="form-control searchable-dropdown" })
                            </label>
                            <label for="" style="width: 15% !important">
                                From
                                @Html.TextBoxFor(model => model.FromDate, new { @class = "formatted-date-input", id = "FromDate" })
                            </label>
                            <label for="" style="width: 15% !important">
                                To
                                @Html.TextBoxFor(model => model.ToDate, new { @class = "formatted-date-input", id = "ToDate" })
                            </label>
                            <button type="button" onclick="submitFilterForm()" class="blueBtn">Search</button>
                            <button type="button" onclick="clearSearchFields()" class="blueBtn">Clear</button>
                        </div>
                    </form>
                </div>


                <div class="flex fourBox gap dashboard-status">
                    <div class="dashboard-box">
                        <p class="flex justify-center align-item-center">
                            <img src="../assets/totalClientIcon.svg" alt="totalClientIcon">
                            Total Client
                        </p>
                        <h3><a href="/MasterClient/Clients" id="totalClients" style="text-decoration: none; color: inherit;"></a></h3>
                    </div>
                    <div class="dashboard-box">
                        <p class="flex justify-center align-item-center">
                            <img src="../assets/briefcase.svg" alt="briefcase">
                            Total Properties
                        </p>
                        <h3><a href="/MasterProperty/Properties" id="totalProjects" style="text-decoration: none; color: inherit;"></a></h3>

                    </div>
                    <div class="dashboard-box">
                        <p class="flex justify-center align-item-center">
                            <img src="../assets/briefcase.svg" alt="briefcase">
                            Open Projects
                        </p> 
                        <h3><a href="/ValuationRequest/ValuationRequests" id="assignprojects" style="text-decoration: none; color: inherit;"></a></h3>
                    </div>
                    <div class="dashboard-box">
                        <p class="flex justify-center align-item-center">
                            <img src="../assets/revenue.svg" alt="revenue">
                            Total Revenue
                        </p>
                        <h3 id="totalRevenue" class="formatting"></h3>
                    </div>
                    <div class="dashboard-box">
                        <p class="flex justify-center align-item-center">
                            <img src="../assets/currency-dollar.svg" alt="currency-dollar">
                            Total Due
                        </p>
                        <h3 id="totalDue" class="formatting"></h3>
                    </div>
                </div>
                <div class="flex dashboard-status">
                    <div class="roundBorderBox w-50">
                        <div class="flex justify-between">
                            <h5>Latest Requests</h5>
                            <a href="#" id="openModalLinklatestRequestsTable">View More</a>
                        </div>
                        <div class="scroll-x">
                            <table class="dashboardTable latestRequestsTable table-striped">
                                <thead>
                                    <tr>
                                        <th>Val Ref#</th>
                                        <th>Property</th>
                                        <th>Client</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="roundBorderBox w-50">
                        <div class="flex justify-between">
                            <h5>Latest Quotations</h5>
                            <a href="#" id="openModalLinklatestQuotationsTable">View More</a>
                        </div>
                        <div class="scroll-x">
                            <table class="dashboardTable latestQuotationsTable table-striped">
                                <thead>
                                    <tr>
                                        <th>Val Ref#</th>
                                        <th>Property</th>
                                        <th>Client</th>
                                        <th>Quotation#</th>
                                        <th>Fee</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="flex dashboard-status">
                    <div class="roundBorderBox w-50">
                        <div class="flex justify-between">
                            <h5>Top Valuation Projects</h5>
                            <a href="#" id="openModalLinktopValuationsTable">View More</a>
                        </div>
                        <div class="scroll-x">
                            <table class="dashboardTable topValuationsTable table-striped">
                                <thead>
                                    <tr>
                                        <th>Val Ref#</th>
                                        <th>Property</th>
                                        <th>Client</th>
                                        <th>Amount</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="roundBorderBox w-50">
                        <div class="flex justify-between">
                            <h5>Top Quotation Dues</h5>
                            <a href="#" id="openModalLinktopQuotationDuesTable">View More</a>
                        </div>
                        <div class="scroll-x">
                            <table class="dashboardTable topQuotationDuesTable table-striped">
                                <thead>
                                    <tr>
                                        <th>Val Ref#</th>
                                        <th>Property</th>
                                        <th>Quotation#</th>
                                        <th>Client</th>
                                        <th>Due</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="dashboardMapArea">
                    <div class="flex flex-column dashboard-status p-0">
                        <div class="roundBorderBox m-0 dashboard-box w-100">
                            <p class="green">Completed Project</p>
                            <h3 class="green" id="completedPerc"></h3>
                        </div>
                        <div class="roundBorderBox dashboard-box w-100">
                            <p class="orange">Pending Project</p>
                            <h3 class="orange" id="pendingPerc"></h3>
                        </div>
                    </div>
                    <div>
                        <iframe src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d29047.38622901107!2d54.395024!3d24.488115!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3e5e67b761b29483%3A0x56ed0c32d62d74fa!2sEltizam%20Asset%20Management%20Group!5e0!3m2!1sen!2sus!4v1699510530470!5m2!1sen!2sus" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div>
                </div>
            </div>

        </div>
    </div>
</main>


<!-- Modal for Latest requests -->
<div class="modal fade" id="myModallatestRequestsTable" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel">All Latest Requests</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>

            </div>
            <div class="modal-body">
                <div style="max-height: 600px; overflow-y: auto;">
                    <!-- Table to display data -->
                    <div class="table-responsive">
                        <table id="data-tablerequest" class="table table-bordered table-striped">
                            <thead>
                                <tr>
                                    <th>Val Ref#</th>
                                    <th>Property</th>
                                    <th>Client</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal for Latest Quaotation Sub -->
<div class="modal fade" id="myModallatestQuotationsTable" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel">All Latest Quotations</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>

            </div>
            <div class="modal-body">
                <div style="max-height: 600px; overflow-y: auto;">
                    <!-- Table to display data -->
                    <table id="data-tablequaotation" class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                <th>Val Ref#</th>
                                <th>Property</th>
                                <th>Client</th>
                                <th>Quotation#</th>
                                <th>Fee</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal for Top projects in valuation -->
<div class="modal fade" id="myModaltopValuationsTable" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel">All Top Valuation Projects</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>

            </div>
            <div class="modal-body">
                <div style="max-height: 600px; overflow-y: auto;">
                    <!-- Table to display data -->
                    <table id="data-tabletopValuations" class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                <th>Val Ref#</th>
                                <th>Property</th>
                                <th>Client</th>
                                <th>Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal for Top Quaotation Due valuation -->
<div class="modal fade" id="myModaltopQuotationDuesTable" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel">All Top Quotation Dues</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>

            </div>
            <div class="modal-body">
                <div style="max-height: 600px; overflow-y: auto;">
                    <!-- Table to display data -->
                    <table id="data-tableQuotationDues" class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                <th>Val Ref#</th>
                                <th>Property</th>
                                <th>Client</th>
                                <th>Quotation#</th>
                                <th>Due</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>


@section MyScripts {
    <script type="text/javascript" src="~/js/custom/Dashboard/Dashboard.js?v=@jsVersion"></script>

    <script>
        //#region Setup API Url
        var AllClient = "@Eltizam.Web.Helpers.APIURLHelper.GetClientByClientTypeId";
        var AllProperty = "@Eltizam.Web.Helpers.APIURLHelper.GetPropertyByFilters";
        var Dashboardurl = "@Eltizam.Web.Helpers.APIURLHelper.DashboardDetails"
    </script>

}