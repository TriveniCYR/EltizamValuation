@using Microsoft.AspNetCore.Http
@using Eltizam.Web.Controllers
@using Microsoft.AspNetCore.Mvc.Localization
@inject IHttpContextAccessor HttpContextAccessor
@inject Microsoft.Extensions.Localization.IStringLocalizer<Eltizam.Resource.Master> MasterLocalizer

@inject Microsoft.Extensions.Localization.IStringLocalizer<Eltizam.Resource.Shared> SharedLocalizer
@using Microsoft.Extensions.Configuration
@inject IConfiguration Configuration

@model Eltizam.Business.Models.Master_PropertyTypeModel
@{
    ViewData["Title"] = @MasterLocalizer["Property Type Manage"]; 
    string jsVersion = @Configuration.GetSection("StaticJS")["version"];

}

<form asp-action="PropertyTypeManage" method="post">
    <main>
        <div class="whiteBoxShadow">
            <div class="heading position-relative">
                <h3 class="dashboardTitle">Property Sub Type</h3>
            </div>
            <div class="bodyContent">
                <div class="inputSearchs">
                    <input type="hidden" id="hdnPropertyId" value="@(Model == null ? 0 : Model.Id)" />
                    <div class="flex mb-28">
                        <label for="" class="w-50">
                            @Html.LabelFor(model => model.PropertyType, new { @class = "control-label" })
                            <span class="text-danger">*</span>
                            @Html.EditorFor(model => model.PropertyType, new { htmlAttributes = new { @autocomplete = "off", @class = "form-control checkbox-checked", @placeholder = @MasterLocalizer["Property Type Name"] } })
                            @Html.ValidationMessageFor(model => model.PropertyType, "", new { @class = "text-danger" })
                        </label>
                        <label for="" class="w-50">
                          
                           @* @Html.LabelFor(model => model.SubTypes.ds,"Property SubType", new { @class = "control-label" })*@
                            <span class="text-danger">*</span>
                            @Html.DropDownListFor(model => model.Id, new List<SelectListItem> { }, new { @class = "form-control", @multiple = "multiple" })
                            @Html.ValidationMessageFor(model => model.Id, "", new { @class = "text-danger" })
                        </label>
                    </div>

                    <div class="flex mb-28">
                        <label for="" class="w-50">
                            Description
                            <span class="text-danger">*</span>
                            @Html.EditorFor(model => model.PropertyType, new { htmlAttributes = new { @autocomplete = "off", @class = "form-control checkbox-checked", @placeholder = @MasterLocalizer["Property Type Name"] } })
                            @Html.ValidationMessageFor(model => model.PropertyType, "", new { @class = "text-danger" })
                        </label>  
                        <label for="" class="w-50">
                            
                            Status
                            <input class='input-switch' type="checkbox" id="addLocation" required />
                            <label class="label-switch" for="addLocation"></label>
                            <span class="info-text"></span>
                        </label>


                       
                    </div>
                    <div class="flex mb-28">
                        <label for="" class="w-50">
                            Property SubType Name
                            @Html.DropDownListFor(model => model.MasterPropertySubTypes, new List<SelectListItem> { }, new { @class = "form-control",/*  @disabled = "disabled" */})
                        </label>


                    </div>

                   @*  <div class="propertySubTypeContainer">
                        @for (var i = 0; i < Model.subType.PropertySubType.Count; i++)
                        {
                            <div class="flex mb-28">
                                <label for="" class="w-50">
                                    <input type="text" asp-for="subType.PropertySubType[i]" class="form-control checkbox-checked" placeholder="Property SubType Name" />
                                </label>
                                @if (i > 0)
                                {
                                    <button type="button" class="btn btn-danger removeSubType" data-row="@i">Remove</button>
                                }
                            </div>
                        }

                    </div> *@
                    <button type="button" id="addSubTypeButton" class="btn btn-secondary">Add Property SubType</button>
                    <div class="text-center buttonArea">
                        <button type="submit" id="btnSaveRole" class="bgBlue mr-12">@SharedLocalizer["Save"]</button>
                        <a class="greyBtn lineBtn formAbtn" asp-action="Designation">@SharedLocalizer["Cancel"]</a>
                    </div>
                </div>
            </div>
        </div>
    </main>
</form>

@section MyScripts {

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>

        $(document).ready(function () {

            var HdnId = $('#hdnPropertyId').val();
            if (HdnId) {

               // alert(HdnId);
                BindPropertySub(HdnId);
            }
        });

        // {
        //     "id": 3,
        //         "propertySubType": "Yalla sub 1",
        //             "isActive": true,
        //                 "createdDate": null,
        //                     "createdBy": null,
        //                         "modifiedDate": null,
        //                             "modifiedBy": null,
        //                                 "propertyTypeId": 0
        // }

        function BindPropertySub(id) {
            debugger;
            alert(id);
            //return false;
            //alert("hello");
            var PropertyByIdSubType = "@Eltizam.Web.Helpers.APIURLHelper.GetPropertyByPropertyTypeId";
            var PropertySubType = $("#PropertySubTypeId");
            var _val = $('#hdnPropertySub').val();
            var _rpname = "propertyTypeId";

            //BindDropdowns(PropertyList, Property, _rpname, _val);
            $.ajax({
                type: "GET",
                url: $('#hdnBaseURL').val() + PropertyByIdSubType + '/' + id,
                "datatype": "json",
                success: function (response) {
                    debugger;
                    for (var i = 0; i < response._object.length; i++) {
                        PropertySubType.empty().append($("<option></option>").val(response._object.id).html(response._object.propertySubType));
                    }
                },
                failure: function (response) {
                    alert(response.responseText);
                },
                error: function (response) {
                    alert(response.responseText);
                    $("#loader").hide();
                }
            });
        }

    </script>
}

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
@* <script>
    $(document).ready(function () {
        var subTypeCounter = @Model.subType.PropertySubType.Count;

        // Function to add a new PropertySubType input
        function addSubTypeInput() {
            subTypeCounter++;
            var subTypeHtml = '<div class="flex mb-28" id="subTypeRow' + subTypeCounter + '">' +
                '<label for="" class="w-50">' +
                '<input type="text" asp-for="subType.PropertySubType[' + subTypeCounter + ']" class="form-control checkbox-checked" placeholder="Property SubType Name" />' +
                '</label>' +
                '<button type="button" class="btn btn-danger removeSubType" data-row="' + subTypeCounter + '">Remove</button>' +
                '</div>';
            $('.propertySubTypeContainer').append(subTypeHtml);
        }

        // Event handler for the plus button
        $('#addSubTypeButton').click(function () {
            addSubTypeInput();
        });

        // Event handler to remove a PropertySubType field
        $(document).on('click', '.removeSubType', function () {
            var rowToRemove = $(this).data('row');
            $('#subTypeRow' + rowToRemove).remove();
        });
    });

</script>
 *@

